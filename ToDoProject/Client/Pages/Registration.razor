@page "/registration"
@using System.ComponentModel.DataAnnotations;


@if (ShowRegistrationErrors && Error != "")
{
                <MudAlert Severity="Severity.Error" ContentAlignment="HorizontalAlignment.Center" ShowCloseIcon="true"
                    CloseIconClicked="(() => ShowRegistrationErrors = false)" Style="margin-bottom: 20px">
                    @Error
                </MudAlert>
}
@if(!IsLoading) 
{
        <EditForm Model="@_request" OnValidSubmit="Register">
        <DataAnnotationsValidator/>
        <MudGrid>
            <MudItem xs="12" sm="7">
                <MudCard>
                    <MudCardHeader>
                        <h3>Registrazione</h3>
                    </MudCardHeader>
                    <MudCardContent>
                            <MudTextField T="string" Label="Nome" Required="true" RequiredError="Il nome è obbligatorio!" @bind-Value="@_request.Name"/>
                            <MudTextField T="string" Label="Cognome" Required="true" RequiredError="Il cognome è obbligatorio" @bind-Value="@_request.Surname"/>
                            <MudTextField T="string" Label="Email" Required="true" RequiredError="L'indirizzo email è obbligatorio" @bind-Value="@_request.Email"
                                      Validation="@(new EmailAddressAttribute() {ErrorMessage = "L'indirizzo email non è valido"})"/>
                            <MudTextField T="string" Label="Password" HelperText="Scegli una password forte"
                                      InputType="InputType.Password" @bind-Value="@_request.Password"
                                      Validation="@(new Func<string, IEnumerable<string>>(PasswordStrength))" Required="true"
                                      RequiredError="La password è obbligatoria!"/>
                            <MudTextField T="string" @bind-Value="@_request.ConfirmPassword"
                                      Label="Password" HelperText="Reinserisci la password" InputType="InputType.Password"
                                      Validation="@(new Func<string, string>(PasswordMatch))"/>
                            <MudDatePicker Label="Data di nascita" Editable="true" @bind-Date="@_request.BirthDate" Placeholder="Seleziona la tua data di nascita" />                    
                    </MudCardContent>
                    <MudCardActions>
                        <div class="d-flex ml-auto">
                            <MudButton Variant="Variant.Filled" ButtonType="ButtonType.Submit" Color="Color.Primary" Class="ml-auto">Registrati</MudButton>
                        </div>
                    </MudCardActions>
                </MudCard>
            </MudItem>
        </MudGrid>
    </EditForm>
}
else
{
    <MudProgressCircular Color="Color.Primary" Indeterminate="true"/>
}